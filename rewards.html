<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Rewards
  #

Unlike observations, we were a little more flexible with rewards with respect to leaking information to the agent. Event rewards are too sparse. It can be thousands of steps before a high value event is met. The agent needs some way knowing it is making progress in between these high value sparse rewards.
Our reward function (contains over 25 parameters!)
  

class ObjectRewardRequiredEventsMapIds(BaselineRewardEnv):
    def get_game_state_reward(self) -> dict[str, float]:
        _, wBagItems = self.pyboy.symbol_lookup("wBagItems")
        numBagItems = self.read_m("wNumBagItems")
        bag_item_ids = set(self.pyboy.memory[wBagItems : wBagItems + 2 * numBagItems : 2])

        return (
            {
                "cut_tiles": self.reward_config["cut_tiles"] * sum(self.cut_tiles.values()),
                "event": self.reward_config["event"] * self.update_max_event_rew(),
                "seen_pokemon": self.reward_config["seen_pokemon"] * np.sum(self.seen_pokemon),
                "caught_pokemon": self.reward_config["caught_pokemon"]
                * np.sum(self.caught_pokemon),
                "obtained_move_ids": self.reward_config["obtained_move_ids"]
                * np.sum(self.obtained_move_ids),
                "hm_count": self.reward_config["hm_count"] * self.get_hm_count(),
                "level": self.reward_config["level"] * self.get_levels_reward(),
                "badges": self.reward_config["badges"] * self.get_badges(),
                "valid_cut_coords": self.reward_config["valid_cut_coords"]
                * len(self.valid_cut_coords.values()),
                "invalid_cut_coords": self.reward_config["invalid_cut_coords"]
                * len(self.invalid_cut_coords.values()),
                "start_menu": self.reward_config["start_menu"] * self.seen_start_menu,
                "pokemon_menu": self.reward_config["pokemon_menu"] * self.seen_pokemon_menu,
                "stats_menu": self.reward_config["stats_menu"] * self.seen_stats_menu,
                "bag_menu": self.reward_config["bag_menu"] * self.seen_bag_menu,
                "explore_hidden_objs": sum(self.seen_hidden_objs.values()),
                "explore_signs": sum(self.seen_signs.values())
                * self.reward_config["explore_signs"],
                "seen_action_bag_menu": self.seen_action_bag_menu
                * self.reward_config["seen_action_bag_menu"],
                "pokecenter_heal": self.pokecenter_heal * self.reward_config["pokecenter_heal"],
                "rival3": self.reward_config["required_event"]
                * int(self.read_m("wSSAnne2FCurScript") == 4),
                "game_corner_rocket": self.reward_config["required_event"]
                * float(self.missables.get_missable("HS_GAME_CORNER_ROCKET")),
                "saffron_guard": self.reward_config["required_event"]
                * float(self.flags.get_bit("BIT_GAVE_SAFFRON_GUARDS_DRINK")),
                "lapras": self.reward_config["required_event"]
                * float(self.flags.get_bit("BIT_GOT_LAPRAS")),
                "a_press": len(self.a_press) * self.reward_config["a_press"],
                "warps": len(self.seen_warps) * self.reward_config["explore_warps"],
                "use_surf": self.reward_config["use_surf"] * self.use_surf,
                "exploration": self.reward_config["exploration"] * np.sum(self.reward_explore_map),
                "safari_zone": sum(
                    self.reward_config["safari_zone"] * v for k, v in self.safari_zone_steps.items()
                )
                / 502.0,
                "use_ball_count": self.reward_config["use_ball_count"] * self.use_ball_count,
                "pokeflute_tiles": self.reward_config["pokeflute_tiles"]
                * sum(self.pokeflute_tiles.values()),
                "surf_tiles": self.reward_config["surf_tiles"] * sum(self.surf_tiles.values()),
                "valid_pokeflute_coords": self.reward_config["valid_pokeflute_coords"]
                * len(self.valid_pokeflute_coords.values()),
                "invalid_pokeflute_coords": self.reward_config["invalid_pokeflute_coords"]
                * len(self.invalid_pokeflute_coords.values()),
                "valid_surf_coords": self.reward_config["valid_surf_coords"]
                * len(self.valid_surf_coords.values()),
                "invalid_surf_coords": self.reward_config["invalid_surf_coords"]
                * len(self.invalid_surf_coords.values()),
            }
            | {
                event: self.reward_config["required_event"] * float(self.events.get_event(event))
                for event in REQUIRED_EVENTS
            }
            | {
                item.name: self.reward_config["required_item"] * float(item.value in bag_item_ids)
                for item in REQUIRED_ITEMS
            }
            | {
                item.name: self.reward_config["useful_item"] * float(item.value in bag_item_ids)
                for item in USEFUL_ITEMS
            }
        )

  


  Sparse vs. Dense Rewards
  #

Sparse rewards are high value rewards, but rarely occur, e.g. gym battles. If we were to only reward the sparse rewards, the agent would never leave the starting point in Pallet Town.'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://drubinstein.github.io/pokerl/docs/chapter-2/rewards/"><meta property="og:site_name" content="Pokémon RL"><meta property="og:title" content="Rewards"><meta property="og:description" content='Rewards # Unlike observations, we were a little more flexible with rewards with respect to leaking information to the agent. Event rewards are too sparse. It can be thousands of steps before a high value event is met. The agent needs some way knowing it is making progress in between these high value sparse rewards.
Our reward function (contains over 25 parameters!) class ObjectRewardRequiredEventsMapIds(BaselineRewardEnv): def get_game_state_reward(self) -> dict[str, float]: _, wBagItems = self.pyboy.symbol_lookup("wBagItems") numBagItems = self.read_m("wNumBagItems") bag_item_ids = set(self.pyboy.memory[wBagItems : wBagItems + 2 * numBagItems : 2]) return ( { "cut_tiles": self.reward_config["cut_tiles"] * sum(self.cut_tiles.values()), "event": self.reward_config["event"] * self.update_max_event_rew(), "seen_pokemon": self.reward_config["seen_pokemon"] * np.sum(self.seen_pokemon), "caught_pokemon": self.reward_config["caught_pokemon"] * np.sum(self.caught_pokemon), "obtained_move_ids": self.reward_config["obtained_move_ids"] * np.sum(self.obtained_move_ids), "hm_count": self.reward_config["hm_count"] * self.get_hm_count(), "level": self.reward_config["level"] * self.get_levels_reward(), "badges": self.reward_config["badges"] * self.get_badges(), "valid_cut_coords": self.reward_config["valid_cut_coords"] * len(self.valid_cut_coords.values()), "invalid_cut_coords": self.reward_config["invalid_cut_coords"] * len(self.invalid_cut_coords.values()), "start_menu": self.reward_config["start_menu"] * self.seen_start_menu, "pokemon_menu": self.reward_config["pokemon_menu"] * self.seen_pokemon_menu, "stats_menu": self.reward_config["stats_menu"] * self.seen_stats_menu, "bag_menu": self.reward_config["bag_menu"] * self.seen_bag_menu, "explore_hidden_objs": sum(self.seen_hidden_objs.values()), "explore_signs": sum(self.seen_signs.values()) * self.reward_config["explore_signs"], "seen_action_bag_menu": self.seen_action_bag_menu * self.reward_config["seen_action_bag_menu"], "pokecenter_heal": self.pokecenter_heal * self.reward_config["pokecenter_heal"], "rival3": self.reward_config["required_event"] * int(self.read_m("wSSAnne2FCurScript") == 4), "game_corner_rocket": self.reward_config["required_event"] * float(self.missables.get_missable("HS_GAME_CORNER_ROCKET")), "saffron_guard": self.reward_config["required_event"] * float(self.flags.get_bit("BIT_GAVE_SAFFRON_GUARDS_DRINK")), "lapras": self.reward_config["required_event"] * float(self.flags.get_bit("BIT_GOT_LAPRAS")), "a_press": len(self.a_press) * self.reward_config["a_press"], "warps": len(self.seen_warps) * self.reward_config["explore_warps"], "use_surf": self.reward_config["use_surf"] * self.use_surf, "exploration": self.reward_config["exploration"] * np.sum(self.reward_explore_map), "safari_zone": sum( self.reward_config["safari_zone"] * v for k, v in self.safari_zone_steps.items() ) / 502.0, "use_ball_count": self.reward_config["use_ball_count"] * self.use_ball_count, "pokeflute_tiles": self.reward_config["pokeflute_tiles"] * sum(self.pokeflute_tiles.values()), "surf_tiles": self.reward_config["surf_tiles"] * sum(self.surf_tiles.values()), "valid_pokeflute_coords": self.reward_config["valid_pokeflute_coords"] * len(self.valid_pokeflute_coords.values()), "invalid_pokeflute_coords": self.reward_config["invalid_pokeflute_coords"] * len(self.invalid_pokeflute_coords.values()), "valid_surf_coords": self.reward_config["valid_surf_coords"] * len(self.valid_surf_coords.values()), "invalid_surf_coords": self.reward_config["invalid_surf_coords"] * len(self.invalid_surf_coords.values()), } | { event: self.reward_config["required_event"] * float(self.events.get_event(event)) for event in REQUIRED_EVENTS } | { item.name: self.reward_config["required_item"] * float(item.value in bag_item_ids) for item in REQUIRED_ITEMS } | { item.name: self.reward_config["useful_item"] * float(item.value in bag_item_ids) for item in USEFUL_ITEMS } ) Sparse vs. Dense Rewards # Sparse rewards are high value rewards, but rarely occur, e.g. gym battles. If we were to only reward the sparse rewards, the agent would never leave the starting point in Pallet Town.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Rewards | Pokémon RL</title>
<link rel=icon href=/pokerl/favicon.png><link rel=manifest href=/pokerl/manifest.json><link rel=canonical href=https://drubinstein.github.io/pokerl/docs/chapter-2/rewards/><link rel=stylesheet href=/pokerl/book.min.f2e8f8f1ab108e207c040cc1adaed3cc56e51b0eb7cdc7688f24014262dff1e7.css integrity="sha256-8uj48asQjiB8BAzBra7TzFblGw63zcdojyQBQmLf8ec=" crossorigin=anonymous><script defer src=/pokerl/fuse.min.js></script><script defer src=/pokerl/en.search.min.76f6b07b29beba06309ae5ae8cbef1d9112d2366c32ef8e5f149d6c894bcb1ae.js integrity="sha256-dvaweym+ugYwmuWujL7x2REtI2bDLvjl8UnWyJS8sa4=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/pokerl/><img src=/pokerl/logo2.png alt=Logo class=book-icon></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><span>Chapter 1: Brief RL Intro</span><ul><li><a href=/pokerl/docs/chapter-1/quickstart/>RL Quickstart</a></li></ul></li><li><span>Chapter 2: Environment, Observations, Rewards, and Policy</span><ul><li><a href=/pokerl/docs/chapter-2/env-setup/>The Environment</a></li><li><a href=/pokerl/docs/chapter-2/observations/>Observations</a></li><li><a href=/pokerl/docs/chapter-2/rewards/ class=active>Rewards</a></li><li><a href=/pokerl/docs/chapter-2/policy/>Policy</a></li></ul></li><li><span>Chapter 3: Building and Running the System</span><ul><li><a href=/pokerl/docs/chapter-3/running/>Running</a></li><li><a href=/pokerl/docs/chapter-3/reading-asm/>Reading RAM</a></li><li><a href=/pokerl/docs/chapter-3/metrics/>Metrics and Visualization</a></li><li><a href=/pokerl/docs/chapter-3/swarm/>The Swarm</a></li></ul></li><li><span>Chapter 4: Concluding Thoughts</span><ul><li><a href=/pokerl/docs/chapter-4/results/>Results</a></li><li><a href=/pokerl/docs/chapter-4/future/>Future</a></li></ul></li><li><span>Appendix</span><ul><li><span>Breaking Down Pokémon</span><ul><li><a href=/pokerl/docs/appendix/breakdown/battling/>Pokémon Battling</a></li><li><a href=/pokerl/docs/appendix/breakdown/8badges/>The 8 Badges</a></li><li><a href=/pokerl/docs/appendix/breakdown/field_interactions/>Field Interactions and Exploration</a></li><li><a href=/pokerl/docs/appendix/breakdown/team_rocket/>Team Rocket</a></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/pokerl/svg/menu.svg class=book-icon alt=Menu></label><h3>Rewards</h3><label for=toc-control><img src=/pokerl/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#sparse-vs-dense-rewards>Sparse vs. Dense Rewards</a></li><li><a href=#is-exploration-all-you-need>Is Exploration All You Need?</a></li></ul></li><li><a href=#making-game-progress>Making Game Progress?</a></li><li><a href=#map-id-rewards>Map ID Rewards</a></li><li><a href=#safari-zone-rewards>Safari Zone Rewards</a></li><li><a href=#level-reward>Level Reward</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=rewards>Rewards
<a class=anchor href=#rewards>#</a></h1><p>Unlike observations, we were a little more flexible with rewards with respect to leaking information to the agent. Event rewards are too sparse. It can be thousands of steps before a high value event is met. The agent needs some way knowing it is making progress in between these high value sparse rewards.</p><details><summary>Our reward function (contains over 25 parameters!)</summary><div class=markdown-inner><div style="border:1px solid #000"><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#cf222e>class</span> <span style=color:#1f2328>ObjectRewardRequiredEventsMapIds</span><span style=color:#1f2328>(</span>BaselineRewardEnv<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>get_game_state_reward</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>)</span> <span style=color:#0550ae>-&gt;</span> <span style=color:#6639ba>dict</span><span style=color:#1f2328>[</span><span style=color:#6639ba>str</span><span style=color:#1f2328>,</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>]:</span>
</span></span><span style=display:flex><span>        _<span style=color:#1f2328>,</span> wBagItems <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>pyboy<span style=color:#0550ae>.</span>symbol_lookup<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;wBagItems&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        numBagItems <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>read_m<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;wNumBagItems&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        bag_item_ids <span style=color:#0550ae>=</span> <span style=color:#6639ba>set</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>pyboy<span style=color:#0550ae>.</span>memory<span style=color:#1f2328>[</span>wBagItems <span style=color:#1f2328>:</span> wBagItems <span style=color:#0550ae>+</span> <span style=color:#0550ae>2</span> <span style=color:#0550ae>*</span> numBagItems <span style=color:#1f2328>:</span> <span style=color:#0550ae>2</span><span style=color:#1f2328>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#1f2328>(</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;cut_tiles&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;cut_tiles&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>cut_tiles<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;event&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;event&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>update_max_event_rew<span style=color:#1f2328>(),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;seen_pokemon&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;seen_pokemon&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> np<span style=color:#0550ae>.</span>sum<span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_pokemon<span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;caught_pokemon&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;caught_pokemon&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> np<span style=color:#0550ae>.</span>sum<span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>caught_pokemon<span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;obtained_move_ids&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;obtained_move_ids&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> np<span style=color:#0550ae>.</span>sum<span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>obtained_move_ids<span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;hm_count&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;hm_count&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>get_hm_count<span style=color:#1f2328>(),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;level&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;level&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>get_levels_reward<span style=color:#1f2328>(),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;badges&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;badges&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>get_badges<span style=color:#1f2328>(),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;valid_cut_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;valid_cut_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>valid_cut_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;invalid_cut_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;invalid_cut_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>invalid_cut_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;start_menu&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;start_menu&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_start_menu<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;pokemon_menu&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;pokemon_menu&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_pokemon_menu<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;stats_menu&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;stats_menu&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_stats_menu<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;bag_menu&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;bag_menu&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_bag_menu<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;explore_hidden_objs&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_hidden_objs<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;explore_signs&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_signs<span style=color:#0550ae>.</span>values<span style=color:#1f2328>())</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;explore_signs&#34;</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;seen_action_bag_menu&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_action_bag_menu
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;seen_action_bag_menu&#34;</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;pokecenter_heal&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>pokecenter_heal <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;pokecenter_heal&#34;</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;rival3&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_event&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>int</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>read_m<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;wSSAnne2FCurScript&#34;</span><span style=color:#1f2328>)</span> <span style=color:#0550ae>==</span> <span style=color:#0550ae>4</span><span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;game_corner_rocket&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_event&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>missables<span style=color:#0550ae>.</span>get_missable<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;HS_GAME_CORNER_ROCKET&#34;</span><span style=color:#1f2328>)),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;saffron_guard&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_event&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>flags<span style=color:#0550ae>.</span>get_bit<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;BIT_GAVE_SAFFRON_GUARDS_DRINK&#34;</span><span style=color:#1f2328>)),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;lapras&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_event&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>flags<span style=color:#0550ae>.</span>get_bit<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;BIT_GOT_LAPRAS&#34;</span><span style=color:#1f2328>)),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;a_press&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>a_press<span style=color:#1f2328>)</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;a_press&#34;</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;warps&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>seen_warps<span style=color:#1f2328>)</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;explore_warps&#34;</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;use_surf&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;use_surf&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>use_surf<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;exploration&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;exploration&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> np<span style=color:#0550ae>.</span>sum<span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_explore_map<span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;safari_zone&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span>
</span></span><span style=display:flex><span>                    <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;safari_zone&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> v <span style=color:#cf222e>for</span> k<span style=color:#1f2328>,</span> v <span style=color:#0550ae>in</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>safari_zone_steps<span style=color:#0550ae>.</span>items<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>                <span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>/</span> <span style=color:#0550ae>502.0</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;use_ball_count&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;use_ball_count&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>use_ball_count<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;pokeflute_tiles&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;pokeflute_tiles&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>pokeflute_tiles<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;surf_tiles&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;surf_tiles&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6639ba>sum</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>surf_tiles<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;valid_pokeflute_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;valid_pokeflute_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>valid_pokeflute_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;invalid_pokeflute_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;invalid_pokeflute_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>invalid_pokeflute_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;valid_surf_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;valid_surf_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>valid_surf_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;invalid_surf_coords&#34;</span><span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;invalid_surf_coords&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>                <span style=color:#0550ae>*</span> <span style=color:#6639ba>len</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>invalid_surf_coords<span style=color:#0550ae>.</span>values<span style=color:#1f2328>()),</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>            <span style=color:#0550ae>|</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                event<span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_event&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>events<span style=color:#0550ae>.</span>get_event<span style=color:#1f2328>(</span>event<span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>                <span style=color:#cf222e>for</span> event <span style=color:#0550ae>in</span> REQUIRED_EVENTS
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>            <span style=color:#0550ae>|</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                item<span style=color:#0550ae>.</span>name<span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;required_item&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span>item<span style=color:#0550ae>.</span>value <span style=color:#0550ae>in</span> bag_item_ids<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>                <span style=color:#cf222e>for</span> item <span style=color:#0550ae>in</span> REQUIRED_ITEMS
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>            <span style=color:#0550ae>|</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                item<span style=color:#0550ae>.</span>name<span style=color:#1f2328>:</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>reward_config<span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;useful_item&#34;</span><span style=color:#1f2328>]</span> <span style=color:#0550ae>*</span> <span style=color:#6639ba>float</span><span style=color:#1f2328>(</span>item<span style=color:#0550ae>.</span>value <span style=color:#0550ae>in</span> bag_item_ids<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>                <span style=color:#cf222e>for</span> item <span style=color:#0550ae>in</span> USEFUL_ITEMS
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>)</span></span></span></code></pre></div></div></div></details><h3 id=sparse-vs-dense-rewards>Sparse vs. Dense Rewards
<a class=anchor href=#sparse-vs-dense-rewards>#</a></h3><p><strong>Sparse rewards</strong> are high value rewards, but rarely occur, e.g. gym battles. If we were to only reward the sparse rewards, the agent would never leave the starting point in Pallet Town.</p><p><strong>Dense rewards</strong> are like breadcrumbs; they occur frequently but with much lower value than a sparse reward. Dense rewards teach the agent how to explore or interact with the world. With dense rewards, the agent can progress and eventually discover the highly valued sparse rewards.</p><h3 id=is-exploration-all-you-need>Is Exploration All You Need?
<a class=anchor href=#is-exploration-all-you-need>#</a></h3><p>Exploration was the foundation for all dense rewards.</p><p>We originally believed that an agent had successfully learned Pokémon if the agent could visit every coordinate in the game’s world. However, we couldn&rsquo;t only use exploration rewards. If we were to only reward unique coordinates, the agent never interacts with Brock. Instead, the agent wanders the world forever collecting new locations until it runs out of locations. We loosened our definition. Now, we consider <em>any</em> interaction a form of exploration.</p><p>In the end, we rewarded:</p><ul><li>The number of unique coordinates visited during a mini-episode.</li><li>The number of signs the agent interacts with during a mini-episode.</li><li>The number of objects the agent interacts with during a mini-episode.</li><li>The number of unique moves taught.</li><li>The number of valid and invalid uses of HMs/Pokéflute in the overworld.</li><li>The number of tile types an HM/Pokéflute was used on.</li><li>The number of unique map ID transitions (warps) visited during a mini-episode.</li><li>The number of unique seen and caught Pokémon.</li></ul><p>We also experimented with rewarding for all locations an agent has pressed the <code>A</code> button (you make selections in Pokémon by pressing <code>A</code>) on and the number of unique menus the agent has visited during an episode. However, the <code>A</code> press and unique menus rewards provided little gain and slowed down training tremendously because the agent would frequently press <code>A</code> instead of focusing on navigation.</p><h2 id=making-game-progress>Making Game Progress?
<a class=anchor href=#making-game-progress>#</a></h2><p>Game progress is defined by accomplishing high value, sparse rewards. These include:</p><ul><li>All required events completed. A required event is an event required to beat the game. Pokémon has around 80 required events.</li><li>All required items obtained. HMs are an example of required items.</li><li>All useful but not required items obtained. The Bicycle is an example of a useful item.</li></ul><p>Without these rewards, the agent would ultimately wander until the mini-episode reset and make no progress.</p><h2 id=map-id-rewards>Map ID Rewards
<a class=anchor href=#map-id-rewards>#</a></h2><div style=text-align:center;display:flex;align-items:center><div class="book-columns flex flex-wrap"><div class="flex-even markdown-inner" style=flex-grow:ZgotmplZ><figure class="ma0 w-75"><img src=/pokerl/docs/chapter-2/rewards/assets/lotsa_agents.png alt="Lots of agents exploring the area where you can get HM02."><figcaption><p>Lots of agents exploring the area where you can get <code>HM02</code>.</p></figcaption></figure></div><div class="flex-even markdown-inner" style=flex-grow:1><figure class="ma0 w-75"><img src=/pokerl/docs/chapter-2/rewards/assets/lotsa2.png alt="Lots of agents exploring the Celadon Game Corner. The agent liked to exploit the object reward the slot machines provided. Sometimes the agent even obtained an Abra."><figcaption><p>Lots of agents exploring the Celadon Game Corner. The agent liked to exploit the object reward the slot machines provided. Sometimes the agent even obtained an Abra.</p></figcaption></figure></div></div></div><p>We observed that in order to &ldquo;solve&rdquo; all events on a map (a map is the currently loaded game area, e.g., town, route, cave floor, etc.), we needed around 10-20 environments exploring the map. For Pokémon, 10-20 agents map to around 10% map ID coverage.</p><p>We regretfully &ldquo;boosted&rdquo; coordinates reward if the agent explored a currently important map ID. On one hand, we are potentially putting the game on rails. On the other hand, we experienced that the agent would not focus on important areas, e.g., Rocket Hideout, unless we boosted rewards for specific map IDs.</p><p>Specific map IDs start the game with a <em>boosted</em> exploration reward <em>until</em> the map ID’s objective is complete. For example, a gym has a boosted reward until it is beaten. Only two map IDs break this rule.</p><ul><li>Route 23 (where the Rival 6 battle occurs) does not get boosted until all gyms are beaten.</li><li>Lavender Tower does not get boosted until Giovanni is defeated in Rocket Hideout and the Silph Scope is acquired. Otherwise, agents do not leave Lavender due to the level up reward obtained from the wild battles inside Lavender Tower.</li></ul><p>We believe we would not need these rewards if the agent could understand text. Often in Pokémon, an NPC will give hints to the player as to where to go next. Our agent could not parse text and therefore would obviously not know where to go.</p><h2 id=safari-zone-rewards>Safari Zone Rewards
<a class=anchor href=#safari-zone-rewards>#</a></h2><figure class="ma0 w-75"><img src=/pokerl/docs/chapter-2/rewards/assets/safarizone.png alt="The green route will lead the player to the required items in the Safari Zone. In the north area, there is a fork in the road that often confuses the agent."><figcaption><p>The green route will lead the player to the required items in the Safari Zone. In the north area, there is a fork in the road that often confuses the agent.</p></figcaption></figure><p>The Safari Zone minigame provided a big challenge. The Safari Zone is a minigame where two required items must be obtained within 500 steps. The Safari Zone can be attempted as long as you can pay the entrance fee. Safari Zone’s route is pretty linear until a fork in the road 75% the way in. We needed to incentivize the agent to get to that fork as fast as possible <em>and</em> take the correct fork.</p><p>We added a specific Safari Zone reward for this case. The agent obtains a reward proportional to the number of steps left for any map ID it reaches within the Safari Zone. Ideally, the agent’s visited mask would prompt the agent to explore both forks within the same episode. In reality, the agent does eventually complete the Safari Zone but it can take thousands of steps during training.</p><h2 id=level-reward>Level Reward
<a class=anchor href=#level-reward>#</a></h2><p>Peter Whidden suggested a level reward in his video.
We took the level reward from Peter Whidden&rsquo;s video without many changes. Any attempt to remove the reward led to a failed experiment.</p><p>The level reward</p><link rel=stylesheet href=/pokerl/katex/katex.min.css><script defer src=/pokerl/katex/katex.min.js></script><script defer src=/pokerl/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>\[
Reward =
\begin{cases}
\sum_{i=1}^{6} \text{level}_i & if \sum_{i=1}^6 \text{level}_i < 15 \\
30 + \frac{\sum_{i=1}^{6} \text{level}_i - 15}{4} & if \sum_{i=1}^6 \text{level}_i >= 15
\end{cases}
\]</span><p>attempts to find a balance between promoting early game leveling and ensuring the agent is focused on exploration over leveling as the game continues.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=next-post><a class=book-btn href="https://drubinstein.github.io/pokerl/docs/chapter-2/observations/?ref=footer" rel=noopener>« Observations</a></div><div class=previous-post><a class=book-btn href="https://drubinstein.github.io/pokerl/docs/chapter-2/policy/?ref=footer" rel=noopener>Policy »</a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#sparse-vs-dense-rewards>Sparse vs. Dense Rewards</a></li><li><a href=#is-exploration-all-you-need>Is Exploration All You Need?</a></li></ul></li><li><a href=#making-game-progress>Making Game Progress?</a></li><li><a href=#map-id-rewards>Map ID Rewards</a></li><li><a href=#safari-zone-rewards>Safari Zone Rewards</a></li><li><a href=#level-reward>Level Reward</a></li></ul></nav></div></aside></main></body></html>